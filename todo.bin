#!/usr/bin/sh
# ==  TODO  ======================================
# Description: Opens todo.md, and adds new date stamp when needed
# Author: chris4727




vars() {
  todo=$HOME/Notes/todo.md
  date="# $(date +'%Y-%m-%d Week %V %A')" # Gives date level 1 heading `# YYYY-MM-DD Week WW Weekday`
  first_line=$(head -n 1 "$todo")
  red="\033[0;31m"
  grn="\033[0;32m"
  nc="\033[0m"
}

echo_vars() {
   echo "$todo"
   echo "$date"
   echo "$first_line"
}

check_args() {
  if [ "$#" -ne 0 ]; then
    printf "${red}Error:${nc} This script does not accept arguments\n"
    printf "${grn}Usage:${nc} todo\n"
    exit 1
  fi
}

add_date() {
  # Check if the current date is on the first line of todo.md
  if [ "$first_line" != "$date" ]; then
  # If not add the current date heading to the top of the file
    sed -i "1i$date\n" "$todo"
  fi
}

main() {
  vars
  #echo_vars
  check_args "$@"
  add_date
  $EDITOR "$todo"
}

main "$@"

